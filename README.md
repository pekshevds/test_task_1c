# test_task_1c

## Постановка задачи
1. Спроектировать и реализовать решение на платформе 1С по расчету услуг сортировки. Услуга состоит из 2-х услуг хранение и обработка. Результат расчета необходимо предоставить пользователю в виде отчета за месяц.
Хранение тарифицируется, за полные сутки (24 часа), если хранение меньше 24 часов тогда услуга считается бесплатной, если хранение заняло 36 часов тогда выставляем за сутки хранения. 

Стоимость дня хранения, 10 рублей без НДС.

Тариф на обработку зависит от типа грузового места: Хаб, Шины, КГТ, МГТ. 

Тариф на Хаб, зависит от среднедневного количества единиц проходящий через хаб (КоличетсвоНаХабеЗаМесяц/КоличествоКалендарныхДней), до 500 ГМ, от 500 до 1000, от 1000 до 2000, от 2000 до 5000, и свыше 5000.
Стоимость обработки (без ндс), для МГТ 10 руб, для шин 50 руб., для КГТ 100 руб.

Тарифы обработки для хабов:
- до 500 ГМ, 500 руб, 
- от 500 до 1000 ГМ, 200 руб.
- от 1000 до 2000 ГМ, 100 руб.
- от 2000 до 5000 ГМ, 70 руб.
- свыше 5000 ГМ, 50 руб.

Если услуги предоставлялись в выходной день, тогда расчет должен производится по двойному тарифу.

2. Данные для расчета, приходят ежемесячно в csv файле, и загружаются оператором в ручную. Каждая строка в файле содержит информацию об уже отсортированном грузовом месте, 
его номере (НомерГрузовогоМеста), дату попадание на сортировку (ДатаПрибытия) и дату завершения сортировки (ДатаУбытия), а также типе грузового места (КодТипаОбработки).

3. Необходимо предусмотреть хранение тарифов, тариф не может изменяться чаще чем раз в месяц.

4. Решение должно быть максимально эффективным и по возможности использовать многопоточную обработку.
5. Исходный код решения необходимо опубликовать в git в формате EDT.

## Как запустить
1. Добавить новый элемент в справочник "ВариантыПороговУстановкиТарифовНаХабы" (например с наименвоанием "Порог 1")
  
  Заполнить следующими значениями:
  
| N | Нижняя граница | Тариф |
|---|----------------|-------|
| 1 | 0              | 500   |
| 2 | 500            | 200   |
| 3 | 1000           | 100   |
| 4 | 2000           | 70    |
| 5 | 5000           | 50    |

2. Добавить записи в регистр "ТарифыНаВсеКромеХабов":

| Период | Код типа обработки | Тариф |
|--------|--------------------|-------|
| 1      | Хранение           | 10    |
| 2      | МГТ                | 10    |
| 3      | КГТ                | 100   |
| 4      | Шины               | 50    |

3. Добавиь запись в регистр "ТарифыНаХабы":

|  Период | Код типа обработки | Порог |
|---------|--------------------|-------|
| 1       | Хаб                | Порог1|

4. Запустить обработку "Панель управления" в разделе "Сервис". Указать путь к файлу и запустить загрузку данных
5. Запусить обработку документов на дату необходимого месяца из обработки "Панель управления"


## p.s.
Забыл добавить в конфигурацию отчет, добавил его как внешний
